# 📚 Azure アーキテクチャ自動生成システム - ユーザーガイド

## 🌐 アクセス方法
**URL**: http://localhost:3002

---

## 🚀 システム概要

**統合インターフェース**で以下の生成機能を提供：
- 🎯 **4エージェント反復改善システム** (高品質・本番環境向け)
- ⚡ **基本生成機能** (迅速なプロトタイピング)

---

## 📖 使い方

### 🎯 **推奨: 4エージェント反復改善システム**

#### 設定手順
1. **高度な評価システム** ✅ にチェック
2. **目標スコア設定**:
   - 60-70点: 開発・テスト環境
   - 75-80点: ステージング環境  
   - **85-90点: 本番環境** (推奨)
   - 90点以上: ミッションクリティカル
3. **最大イテレーション**: 5回 (推奨)
4. **要件入力**: 詳細な機能・非機能要件
5. **「4エージェント反復改善実行」** クリック

#### 📊 評価システム (各25点、計100点)
- **🛡️ セキュリティ**: Private Endpoint、マネージドID、暗号化
- **⚡ パフォーマンス**: オートスケール、CDN、レスポンス最適化
- **🔧 信頼性**: 可用性ゾーン、災害復旧、監視
- **💰 コスト最適化**: 適切なSKU、予約インスタンス、効率設計

#### 処理フロー
```
1. 初期Bicep生成
2. 4エージェント並列評価 → 合計スコア算出
3. 目標スコア達成判定
   ├─ 達成 → 終了
   └─ 未達成 → 改善提案統合 → Bicep修正 → 次イテレーション
4. 最終成果物出力
```

### ⚡ **基本生成** (迅速なプロトタイピング)

1. **高度な評価システム** ❌ のままにする
2. **出力タイプ選択**: Bicep / 構成図 / 両方
3. **要件入力**: シンプルな要件記述
4. **「アーキテクチャ生成」** クリック

### 📊 **レート制限回避のコツ**

システムには自動的なレート制限対策が組み込まれています：
- **エージェント間待機**: 10秒
- **イテレーション間待機**: 30秒  
- **自動リトライ**: 指数バックオフ方式

**推奨設定**:
- 軽量なアーキテクチャ: 目標スコア 80-85点
- 標準的なアーキテクチャ: 目標スコア 75-80点
- 複雑なアーキテクチャ: 目標スコア 70-75点、または基本生成モードを使用

### 📊 **従来機能** (比較用)

- 画面下部の「従来機能を表示（比較用）」で展開
- 旧マルチエージェント、評価フィードバック等

---

## 💡 要件記述のベストプラクティス

### ✅ **推奨例**
```
APIM + App Service + PostgreSQL構成
- 地域: Japan East
- 可用性: 99.9%以上、ゾーン冗長
- セキュリティ: Private Endpoint、マネージドID使用
- DR: Geo-冗長、RTO 4時間、RPO 1時間
- コンプライアンス: ISO27001、監査ログ必須
- スケール: 最大1000同時接続
- パフォーマンス: レスポンス時間500ms以下
```

### ❌ **避けるべき例**
```
Webアプリを作りたい
データベースも必要
```

---

## 📊 出力結果の見方

### 🎯 **4エージェント結果**
1. **最終スコア**: 5つのカード表示（総合+4分野別）
2. **改善履歴**: 各イテレーションのスコア推移
3. **詳細評価**: 分野別の具体的指摘事項
4. **最終Bicep**: 改善済み高品質テンプレート
5. **Mermaid図**: 最終アーキテクチャ構成図

### 🔧 **基本生成結果**
1. **Bicepコード**: コピー・ダウンロード可能
2. **アーキテクチャ図**: Mermaid形式で視覚化

---

## 🎯 利用シーン別推奨設定

### 🏢 **エンタープライズ本番環境**
- ✅ 4エージェント反復改善
- 🎯 目標スコア: 85-90点
- 🔄 最大イテレーション: 5回
- 📝 詳細要件 (DR、コンプライアンス必須)

### 🧪 **開発・テスト環境**
- ✅ 4エージェント反復改善
- 🎯 目標スコア: 70-80点
- 🔄 最大イテレーション: 3回
- 📝 基本要件中心

### ⚡ **プロトタイピング**
- ❌ 基本生成モード
- 📝 シンプルな要件記述
- 🚀 迅速な結果取得

---

## 🚀 システムの特徴

### 📈 **4エージェント反復改善システム**
1. **Azure WAF完全準拠**: Well-Architected Framework 5原則対応
2. **詳細評価**: 100点満点での厳密な品質評価  
3. **根拠明示**: 各減点項目の具体的指摘
4. **自動改善**: ルールベースでの体系的な修正
5. **トレーサビリティ**: 全変更履歴の記録
6. **再現性**: 同一要件での一貫した結果
7. **エンタープライズ対応**: 本番環境即適用可能

### 🔄 **統合インターフェース**
1. **シンプル操作**: 直感的な単一画面
2. **柔軟選択**: 用途に応じて機能選択
3. **段階利用**: 基本→高度へのスムーズな移行

---

## ✅ 品質基準・受け入れ基準

### 🎯 **スコア別品質レベル**
- **90点以上**: ミッションクリティカル対応
- **85-90点**: 本番環境標準品質
- **80-85点**: ステージング環境品質
- **70-80点**: 開発・テスト環境品質
- **60-70点**: プロトタイプ・学習用

### ✅ **受け入れ基準**
1. **セキュリティ**: パブリックアクセス・未暗号化禁止
2. **信頼性**: 単一障害点の排除
3. **コンプライアンス**: 監査証跡・ポリシー準拠
4. **再現性**: 同一要件で目標スコア±3点以内

---

## 🛠️ トラブルシューティング

### ❌ **よくあるエラー**
1. **空の要件**: 詳細な要件を記述してください
2. **低いスコア**: 目標スコアを下げるか、要件を詳細化
3. **タイムアウト**: 複雑すぎる要件は分割して実行
4. **レート制限エラー**: 基本生成モードを試すか、目標スコアを下げてください

### ⚠️ **Azure OpenAI レート制限対策**
- **Standard プラン**: 4エージェント実行に時間がかかる場合があります（1イテレーション約2-3分）
- **推奨**: 基本生成モードを試すか、目標スコアを下げてください
- **将来的改善**: Azure OpenAI のTPM制限増加やプラン変更を検討

### 💡 **パフォーマンス向上のコツ**
1. **具体的要件**: 抽象的表現を避ける
2. **段階的実行**: 基本→高度の順で確認
3. **適切な目標**: 環境に応じた現実的なスコア設定
4. **レート制限回避**: 基本生成モードの活用

これで、1つの統合インターフェースで全機能が利用でき、用途に応じて最適な方法を選択できます！🎉
